Урок 40 Каскадирование в БД
(каскадное удаление в таблицах)


Пример
У нас есть 2 таблицы Person, Order - example.png
которые связаны между собой соотношением один-ко-многим
Если из таблицы Person мы начнем удалять человека,
например,

delete from Person where user_id=3

то получим ошибку, т.к. база по умолчанию настроена таким образом,
что выдает ошибку при удалении связанных данных.
Подчиненной таблице непонятно на кого ссылаться.

Каскадирование
настраивает базу данных - как надо реагировть на удаление

При создании таблицы "Order"
(в двойных кавычках, т.к. есть такое ключевое слово)

1)
user_id int references Person(user_id) on delete cascade
Удаляет строки в зависимой таблице при удалении связанных
строк в главной таблице (удалили человека - удаляются
все связанные с ним заказы

2)
user_id int references Person(user_id) on delete set null
Выставляет значение внешнего ключа равным NULL
при удалении связанных строк в главной таблице
(удалили человека - теперь закзы ничейные)

3)
user_id int references Person(user_id) on delete restrict
Поведение по умолчанию. Выдает ошибку
при попытке удалить человека.



